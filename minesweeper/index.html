<!DOCTYPE html>
<meta name="viewport" content="width=480,user-scalable=no" />
<html>
    <head>
        <title>Fractals using Probability</title>
    </head>
    <body>
        <div class="header">
            <div class="title-box">
                <h1>"Minesweeper"</h1>
                <h2>Literally minesweeper.</h2>
                <p>Play minesweeper.</p>
            </div>
            <div class="options-box">
                <a>
                Option 1 : <input id="option1" type="number" value="3" style="width: 5em; margin-right: 1em;" placeholder="Option 1">
                </a><a>
                Option 2: <input id="option2" type="number" value="2" style="width: 5em; margin-right: 1em;" placeholder="Option 2">
                </a><a>
                Option 3: <input id="option3" type="number" value="1000" style="width: 5em; margin-right: 1em;" placeholder="Option 3">
                </a>
                <button id="refreshBtn" style="width:5em; margin-left: 1em;">Refresh</button>
            </div>
        </div>
        <div class="canvas-box">
            <canvas id="myCanvas" width="750" height="750"></canvas>
        </div>
    </body>
    <script>
        // Javascript for probability fractal generator
        // Author: Noah Synowiec

        // canvas variables
        var canvas = document.getElementById("myCanvas");
        var ctx = canvas.getContext("2d");
        canvas.width = window.innerHeight*4/5;
        canvas.height = window.innerHeight*4/5;
        var width = canvas.width;
        var height = canvas.height;
        var frameRate = 100;
        // game variables
        var grid_width = 15;
        var grid_height = grid_width;
        var cell_size = canvas.height / grid_height;
        var percent_fill = 0.1;
        var grid = []
        generate_grid();

        document.addEventListener("mouseup", mouseUpHandler);
        //document.getElementById("refreshBtn").addEventListener("click", refresh);
        var drawInt = setInterval(draw, frameRate);
        draw();

        function generate_grid() {

            // loop through grid and draw
            for (let row = 0; row < grid_width; row++) {
                grid.push([]);
                for (let col = 0; col< grid_height; col++) {
                    if (Math.random() < percent_fill) {
                        grid[row].push(1);
                    } else {
                        grid[row].push(-1);
                    }
                }
            }
        }

        // 'click' on the cell corresponding to the mouse's x, y position
        function click(x, y) {
            row = Math.floor(x / cell_size);
            col = Math.floor(y / cell_size)
            grid[row][col] *= -1 ;
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height)           

            // loop through grid and draw
            for (let row = 0; row < grid_width; row++) {
                for (let col = 0; col < grid_height; col++) {
                    // set colors
                    row_mod = (Math.floor(155 / grid_width)) * row + 50
                    col_mod = (Math.floor(155 / grid_height)) * col + 50
                    r = row_mod
                    g = Math.floor((row_mod + col_mod) / 4)
                    b = col_mod
                    color = `rgb(${r}, ${g}, ${b})`
                    
                    if (grid[row][col] == 1) {
                        drawCell(row, col, "red");
                    } else {
                        drawCell(row, col, color);
                    }
 
                }
            }
        }

        function drawCell(x, y, color) {
            ctx.beginPath();
            ctx.rect(x*cell_size, y*cell_size, cell_size+1, cell_size+1);
            ctx.fillStyle = color;
            ctx.fill();
        }

        function mouseUpHandler(e) {
            click(e.offsetX, e.offsetY)
        }


    </script>
    <style>
        * { 
            padding: 0; 
            margin: 0; 
        }
        html {
            background-color: gray;
        }
        canvas { 
            background: white; 
            display: block; 
            margin: 0 auto; 
        }
        .header {
            background-color: white;
            border-radius: 0vh 0vh 10vh 10vh;
        }
        .title-box {
            width: 100vw;
            height: 14vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            place-content: center;
        }
        .options-box {
            width: 100vw;
            height: 6vh;
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            align-items: center;
            place-content: center;
        }
        .canvas-box {
            width: 100vw;
            height: 80vh;
            overflow: hidden;
            display: grid;
            place-content: center;
        }
    </style>
</html>